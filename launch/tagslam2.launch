<launch>
  <arg name="output" default="screen"/>
  <arg name="example"/>
  <!-- point cloud transformation nodelet  -->
#	launch-prefix="gdb -ex run --args"
  <arg name="data_dir" default="$(find tagslam)/examples/example_$(arg example)"/>
  <arg name="config_dir" default="$(arg data_dir)/config"/>
  
  <arg name="tagslam_config_file" default="$(arg config_dir)/tagslam2.yaml"/>
  <arg name="calibration_file" default="$(arg config_dir)/cameras.yaml"/>
  <arg name="camera_poses_file" default="$(arg config_dir)/camera_poses.yaml"/>
  <arg name="bag" default="$(arg data_dir)/tag_detections.bag"/>
  <arg name="max_number_of_frames" default="1000000"/>

  <!--
  <node pkg="nodelet" type="nodelet" name="tagslam2" args="standalone tagslam/TagSlam2"
	output="$(arg output)">
        <rosparam param="cameras" command="load" file="$(arg calibration_file)"/>
        <rosparam param="tagslam_config" command="load" file="$(arg tagslam_config_file)"/>
	<param name="bag_file" value="$(arg bag)"/>
	<param name="has_compressed_images" value="true"/>
	<param name="max_number_of_frames" value="6"/>
	</node>
  -->
  <!--
      visualize dot files:
      dot -Kfdp -Tpng ~/.ros/final_0.dot > bar.png ; eog bar.png
      -->
#	launch-prefix="gdb -ex run --args"
  <node pkg="tagslam" type="tagslam2_node" name="tagslam2" clear_params="true"
	output="$(arg output)">
        <rosparam param="cameras" command="load" file="$(arg calibration_file)"/>
        <rosparam param="tagslam_config" command="load" file="$(arg tagslam_config_file)"/>
	<rosparam command="load" file="$(arg camera_poses_file)"/>
	<!--
	    <param name="bag_start_time" value="190.0"/>
	    <param name="bag_start_time" value="13.1"/>
	    	<param name="bag_start_time" value="26.5"/>
	-->
	<param name="bag_start_time" value="0"/>
	<param name="bag_file" value="$(arg bag)"/>
	<param name="optimize_full_graph" value="true"/>
	<param name="max_subgraph_error" value="50.0"/>
	<param name="has_compressed_images" value="false"/>
	<param name="minimum_viewing_angle" value="20.0"/>
	<param name="max_number_of_frames" value="$(arg max_number_of_frames)"/>
  </node>

</launch>
